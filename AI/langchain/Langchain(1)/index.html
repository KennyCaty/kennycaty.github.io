<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Langchain（一）：第一个LangChain程序，提示模板和解析器 | KennyCaty-啃泥猫-BLOG</title><meta name="author" content="KennyCaty"><meta name="copyright" content="KennyCaty"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="LangChain的Model， Prompts和Parsers">
<meta property="og:type" content="article">
<meta property="og:title" content="Langchain（一）：第一个LangChain程序，提示模板和解析器">
<meta property="og:url" content="http://example.com/AI/langchain/Langchain(1)/index.html">
<meta property="og:site_name" content="KennyCaty-啃泥猫-BLOG">
<meta property="og:description" content="LangChain的Model， Prompts和Parsers">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://w.wallhaven.cc/full/vq/wallhaven-vqgzql.png">
<meta property="article:published_time" content="2023-08-17T04:58:38.000Z">
<meta property="article:modified_time" content="2023-08-17T14:15:49.444Z">
<meta property="article:author" content="KennyCaty">
<meta property="article:tag" content="Langchain">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://w.wallhaven.cc/full/vq/wallhaven-vqgzql.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/AI/langchain/Langchain(1)/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":300},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Langchain（一）：第一个LangChain程序，提示模板和解析器',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-08-17 22:15:49'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/kennycaty.ico" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">18</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://w.wallhaven.cc/full/vq/wallhaven-vqgzql.png')"><nav id="nav"><span id="blog-info"><a href="/" title="KennyCaty-啃泥猫-BLOG"><span class="site-name">KennyCaty-啃泥猫-BLOG</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Langchain（一）：第一个LangChain程序，提示模板和解析器</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-08-17T04:58:38.000Z" title="发表于 2023-08-17 12:58:38">2023-08-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-08-17T14:15:49.444Z" title="更新于 2023-08-17 22:15:49">2023-08-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Langchain/">Langchain</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Langchain（一）：第一个LangChain程序，提示模板和解析器"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>reference：</p>
<p><a target="_blank" rel="noopener" href="https://www.deeplearning.ai/short-courses/langchain-for-llm-application-development/">LangChain&amp;DeepLearningAI</a></p>
<h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>LangChain是一个用于构建LLM应用的开源开发框架，目前有Python和JavaScript两种包，它们<strong>专注与组合和模块化</strong></p>
<p>特点：</p>
<ul>
<li><p>有许多可与彼此或单独使用的个体组件</p>
</li>
<li><p>用例众多，极易入门</p>
</li>
</ul>
<p>重要部分</p>
<ul>
<li><p>Models</p>
<ul>
<li>LLMs：20+integrations</li>
<li>Chat Models</li>
<li>Text Embedding Models：10+integrations</li>
</ul>
</li>
<li><p>Prompts</p>
<ul>
<li>Prompt Templates</li>
<li>Output Parsers：5+implementations<ul>
<li>Retry/fixing logic</li>
</ul>
</li>
<li>Example Selectors：5+implementations</li>
</ul>
</li>
<li><p>Indexes 将数据注入系统以与模型结合使用的方式</p>
<ul>
<li>Document Loaders：50+implementations</li>
<li>Text Splitters：10+implementations</li>
<li>Vector stores：10+integrations</li>
<li>Retrievers：5+integrations/implementations</li>
</ul>
</li>
<li><p>Chains</p>
<ul>
<li>Prompt + LLM + Output parsing</li>
<li>Can be used as building blocks for longer chains</li>
<li>More application specific chains：20+types</li>
</ul>
</li>
<li><p>Agents</p>
<ul>
<li>Agent Types</li>
<li>Agent Toolkits</li>
</ul>
</li>
</ul>
<h1 id="Models-Prompts-and-Parsers"><a href="#Models-Prompts-and-Parsers" class="headerlink" title="Models, Prompts and Parsers"></a>Models, Prompts and Parsers</h1><blockquote>
<p> 以下代码在<strong>jupyter</strong>中运行</p>
</blockquote>
<h2 id="引出模板"><a href="#引出模板" class="headerlink" title="引出模板"></a>引出模板</h2><p>由普通调用GPT 引出Langchain调用GPT</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openai</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment">#pip install python-dotenv</span></span><br><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv, find_dotenv</span><br><span class="line">_ = load_dotenv(find_dotenv())  <span class="comment"># read local .env file</span></span><br><span class="line">openai.api_key = os.environ[<span class="string">&#x27;OPENAI_API_KEY&#x27;</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 调用ChatGPT的辅助函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_completion</span>(<span class="params">prompt, model=<span class="string">&quot;gpt-3.5-turbo&quot;</span></span>):</span><br><span class="line">    messages = [&#123;<span class="string">&quot;role&quot;</span>:<span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>:prompt&#125;]</span><br><span class="line">    response = openai.ChatCompletion.create(</span><br><span class="line">        model=model,</span><br><span class="line">        messages=messages,</span><br><span class="line">        temperature=<span class="number">0</span>,</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> response.choices[<span class="number">0</span>].message[<span class="string">&quot;content&quot;</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get_completion(<span class="string">&quot;What is 1+1?&quot;</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>‘1+1 equals 2.’</p>
</blockquote>
<p>为了推动模型，提示和解析器的Langchain抽象化，假设我们收到一封用户用其他语言写的电子邮件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">customer_email = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Arrr,I be fuming that me blender lid \</span></span><br><span class="line"><span class="string">flew off and splattered me kitchen walls \</span></span><br><span class="line"><span class="string">with smoothie!And to make matters worse,\</span></span><br><span class="line"><span class="string">the warranty don&#x27;t cover the cost of \</span></span><br><span class="line"><span class="string">cleaning up me kitchen.I need yer help \</span></span><br><span class="line"><span class="string">right now,matey!</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>要求LLM以平静和尊重的口吻将文本翻译为美式英语</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">style = <span class="string">&quot;&quot;&quot;American English \</span></span><br><span class="line"><span class="string">in a calm and respectful tone.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">prompt = <span class="string">f&quot;&quot;&quot;Tanslate the text \</span></span><br><span class="line"><span class="string">that is delimited by triple backticks</span></span><br><span class="line"><span class="string">into a style that is <span class="subst">&#123;style&#125;</span>.</span></span><br><span class="line"><span class="string">text: ```<span class="subst">&#123;customer_email&#125;</span>```</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(prompt)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tanslate the text that is delimited by triple backticks<br>into a style that is American English in a calm and respectful tone.<br>text: ```<br>Arrr,I be fuming that me blender lid flew off and splattered me kitchen walls with smoothie!And to make matters worse,the warranty don’t cover the cost of cleaning up me kitchen.I need yer help right now,matey!</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response = get_completion(prompt)  <span class="comment"># 调用GPT</span></span><br><span class="line">response</span><br></pre></td></tr></table></figure>
<blockquote>
<p>‘I am quite frustrated that my blender lid unexpectedly flew off and made a mess of my kitchen walls with smoothie! Additionally, the warranty does not cover the expenses for cleaning up my kitchen. I kindly request your assistance at this moment, my friend.’</p>
</blockquote>
<p>想象一下，如果有不同的客户用不同语言写邮件，英语法语德语等，需要生成一系列的提示来生成这样的翻译</p>
<p><strong>Langchain如何更优雅的做到这一点？</strong></p>
<p>使用Model将一些常用LLM API封装了起来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chat_models <span class="keyword">import</span> ChatOpenAI</span><br><span class="line"><span class="comment"># 这是langchain GPT API 的抽象</span></span><br><span class="line">chat = ChatOpenAI()</span><br><span class="line">chat</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ChatOpenAI(cache=None, verbose=False, callbacks=None, callback_manager=None, tags=None, metadata=None, client=<class 'openai.api_resources.chat_completion.chatcompletion'>, model_name=’gpt-3.5-turbo’, temperature=0.7, model_kwargs={}, openai_api_key=’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’, openai_api_base=’’, openai_organization=’’, openai_proxy=’’, request_timeout=None, max_retries=6, streaming=False, n=1, max_tokens=None, tiktoken_model_name=None)</class></p>
<p>以上都是可以在ChatOpenAI()中设置的参数，比如ChatOpenAI( temperature=0.0 )</p>
</blockquote>
<p>定义模板</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">template_string = <span class="string">&quot;&quot;&quot;Translate the text \</span></span><br><span class="line"><span class="string">that is delimited by triple backticks \</span></span><br><span class="line"><span class="string">into a style that is &#123;style&#125;. \</span></span><br><span class="line"><span class="string">text: ```&#123;text&#125;```</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>为了重复使用这个模板，我们导入Langchain的提示模板</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> ChatPromptTemplate</span><br><span class="line">prompt_template = ChatPromptTemplate.from_template(template_string)</span><br></pre></td></tr></table></figure>
<p>可以使用 <code>prompt_template.messages[0].prompt</code> 查看prompt对象</p>
<p>可以使用 <code>prompt_template.messages[0].prompt.input_variables</code>查看需要在模板插入的内容</p>
<p>定义在模板插入的内容</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">customer_style = <span class="string">&quot;&quot;&quot;American English \</span></span><br><span class="line"><span class="string">in a calm and respectful tone.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">customer_email = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Arrr,I be fuming that me blender lid \</span></span><br><span class="line"><span class="string">flew off and splattered me kitchen walls \</span></span><br><span class="line"><span class="string">with smoothie!And to make matters worse,\</span></span><br><span class="line"><span class="string">the warranty don&#x27;t cover the cost of \</span></span><br><span class="line"><span class="string">cleaning up me kitchen.I need yer help \</span></span><br><span class="line"><span class="string">right now,matey!</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p><strong>使用模板格式化</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">customer_messages = prompt_template.format_messages(</span><br><span class="line">                    style=customer_style,</span><br><span class="line">                    text=customer_email )</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(customer_messages))  <span class="comment"># 返回一个列表</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(customer_messages[<span class="number">0</span>]))  <span class="comment">#第一个就是HumanMessage模板内容</span></span><br><span class="line"><span class="built_in">print</span>(customer_messages[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>
<blockquote>
<p><class 'list'></class></p>
<p><class 'langchain.schema.messages.humanmessage'><br>content=”Translate the text that is delimited by triple backticks into a style that is American English in a calm and respectful tone.\n. text: ```\nArrr,I be fuming that me blender lid flew off and splattered me kitchen walls with smoothie!And to make matters worse,the warranty don’t cover the cost of cleaning up me kitchen.I need yer help right now,matey!\n```\n” additional_kwargs={} example=False</class></p>
</blockquote>
<p><strong>调用GPT</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">customer_response = chat(customer_messages)</span><br><span class="line">customer_response.content</span><br></pre></td></tr></table></figure>
<blockquote>
<p>“Arrr, I’m quite upset that my blender lid flew off and splattered my kitchen walls with smoothie! And to make matters worse, the warranty doesn’t cover the cost of cleaning up my kitchen. I would greatly appreciate your help at this moment, matey!”</p>
</blockquote>
<p>顾客的语言可能是其他语言以及想要翻译成其他风格，只需要在模板格式化（format）时更改模板中相应内容即可</p>
<h2 id="为什么要使用提示模板"><a href="#为什么要使用提示模板" class="headerlink" title="为什么要使用提示模板"></a>为什么要使用提示模板</h2><blockquote>
<p> 为什么要使用Prompt模板而不是直接使用字符串？</p>
</blockquote>
<p>随着构建复杂的应用，提示可能会变得非常长而且详细，所以模板是对提示的抽象，可以在构建复杂应用时<strong>提高复用性</strong>，比如下面这个例子，要让结果更精确，往往需要更细节的提示</p>
<p><img src="/AI/langchain/Langchain(1)/Langchain(1" alt="image-20230817142700814">/image-20230817142700814.png)</p>
<p>Langchain还内置了一些常用的提示，比如summarization，question answering， 连接数据库或其他API等，通过使用内置提示，可以快速构建应用而不用自己写提示</p>
<blockquote>
<p>Output Parsing输出解析</p>
</blockquote>
<p>使用模板能提示语言模型按照特定格式生成输出，比如使用特定关键词</p>
<p>下面的示例使用的时Langchain默认的模型思维链推理框架：<strong>ReAct框架</strong></p>
<p><strong>思维链</strong>：能够给予模型一个思考过程，以达到更精确的结论（在后面的<strong>Agent</strong>用途很大）</p>
<p><img src="/AI/langchain/Langchain(1)/Langchain(1" alt="image-20230817143439909">/image-20230817143439909.png)</p>
<p>模板与解析器的结合可以很好的<strong>抽象指定LLM的输入</strong>，并且使解析器<strong>正确解析LLM的输出</strong></p>
<h2 id="Ouput-Parser示例"><a href="#Ouput-Parser示例" class="headerlink" title="Ouput Parser示例"></a>Ouput Parser示例</h2><blockquote>
<p>LangCain解析LLM的Json输出</p>
<p>示例：从一个产品评论中提取信息并以JSON的格式，格式化输出</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一个期望输出的示例</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;gift&quot;</span>: <span class="literal">False</span>, <span class="comment"># 是否是别人送的礼物</span></span><br><span class="line">    <span class="string">&quot;delivery_days&quot;</span>: <span class="number">5</span>,   <span class="comment">#所需交付天数</span></span><br><span class="line">    <span class="string">&quot;price_value&quot;</span>: <span class="string">&quot;pretty affordable&quot;</span> <span class="comment"># 价格怎么样</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">customer_review = <span class="string">&quot;&quot;&quot;\</span></span><br><span class="line"><span class="string">This leaf blower is pretty amazing.  It has four settings:\</span></span><br><span class="line"><span class="string">candle blower, gentle breeze, windy city, and tornado. \</span></span><br><span class="line"><span class="string">It arrived in two days, just in time for my wife&#x27;s \</span></span><br><span class="line"><span class="string">anniversary present. \</span></span><br><span class="line"><span class="string">I think my wife liked it so much she was speechless. \</span></span><br><span class="line"><span class="string">So far I&#x27;ve been the only one using it, and I&#x27;ve been \</span></span><br><span class="line"><span class="string">using it every other morning to clear the leaves on our lawn. \</span></span><br><span class="line"><span class="string">It&#x27;s slightly more expensive than the other leaf blowers \</span></span><br><span class="line"><span class="string">out there, but I think it&#x27;s worth it for the extra features.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">review_template = <span class="string">&quot;&quot;&quot;\</span></span><br><span class="line"><span class="string">For the following text, extract the following information:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">gift: Was the item purchased as a gift or present for someone else? \</span></span><br><span class="line"><span class="string">Answer True if yes, False if not or unknown.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">delivery_days: How many days did it take for the product \</span></span><br><span class="line"><span class="string">to arrive? If this information is not found, output -1.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">price_value: Extract any sentences about the value or price,\</span></span><br><span class="line"><span class="string">and output them as a comma separated Python list.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Format the output as JSON with the following keys:</span></span><br><span class="line"><span class="string">gift</span></span><br><span class="line"><span class="string">delivery_days</span></span><br><span class="line"><span class="string">price_value</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">text: &#123;text&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> ChatPromptTemplate</span><br><span class="line"></span><br><span class="line">prompt_template = ChatPromptTemplate.from_template(review_template)</span><br><span class="line"><span class="built_in">print</span>(prompt_template)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">messages = prompt_template.format_messages(text=customer_review)</span><br><span class="line">chat = ChatOpenAI(temperature=<span class="number">0.0</span>)</span><br><span class="line">response = chat(messages)</span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure>
<p>检查响应的type， <code>type(response.content)</code> 其实是一个字符串，如果用键值对索引方式会报错</p>
<blockquote>
<p> 将LLM输出字符串解析为Python字典</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.output_parsers <span class="keyword">import</span> ResponseSchema</span><br><span class="line"><span class="keyword">from</span> langchain.output_parsers <span class="keyword">import</span> StructuredOutputParser</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">gift_schema = ResponseSchema(name=<span class="string">&quot;gift&quot;</span>,</span><br><span class="line">                             description=<span class="string">&quot;Was the item purchased\</span></span><br><span class="line"><span class="string">                             as a gift for someone else? \</span></span><br><span class="line"><span class="string">                             Answer True if yes,\</span></span><br><span class="line"><span class="string">                             False if not or unknown.&quot;</span>)</span><br><span class="line">delivery_days_schema = ResponseSchema(name=<span class="string">&quot;delivery_days&quot;</span>,</span><br><span class="line">                                      description=<span class="string">&quot;How many days\</span></span><br><span class="line"><span class="string">                                      did it take for the product\</span></span><br><span class="line"><span class="string">                                      to arrive? If this \</span></span><br><span class="line"><span class="string">                                      information is not found,\</span></span><br><span class="line"><span class="string">                                      output -1.&quot;</span>)</span><br><span class="line">price_value_schema = ResponseSchema(name=<span class="string">&quot;price_value&quot;</span>,</span><br><span class="line">                                    description=<span class="string">&quot;Extract any\</span></span><br><span class="line"><span class="string">                                    sentences about the value or \</span></span><br><span class="line"><span class="string">                                    price, and output them as a \</span></span><br><span class="line"><span class="string">                                    comma separated Python list.&quot;</span>)</span><br><span class="line"></span><br><span class="line">response_schemas = [gift_schema, </span><br><span class="line">                    delivery_days_schema,</span><br><span class="line">                    price_value_schema]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">output_parser = StructuredOutputParser.from_response_schemas(response_schemas)</span><br><span class="line">format_instructions = output_parser.get_format_instructions()</span><br><span class="line"><span class="built_in">print</span>(format_instructions)</span><br></pre></td></tr></table></figure>
<p>新的格式化模板</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">review_template_2 = <span class="string">&quot;&quot;&quot;\</span></span><br><span class="line"><span class="string">For the following text, extract the following information:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">gift: Was the item purchased as a gift for someone else? \</span></span><br><span class="line"><span class="string">Answer True if yes, False if not or unknown.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">delivery_days: How many days did it take for the product\</span></span><br><span class="line"><span class="string">to arrive? If this information is not found, output -1.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">price_value: Extract any sentences about the value or price,\</span></span><br><span class="line"><span class="string">and output them as a comma separated Python list.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">text: &#123;text&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#123;format_instructions&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">prompt = ChatPromptTemplate.from_template(template=review_template_2)</span><br><span class="line"></span><br><span class="line">messages = prompt.format_messages(text=customer_review, </span><br><span class="line">                                format_instructions=format_instructions)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(messages[<span class="number">0</span>].content)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response = chat(messages)</span><br><span class="line"><span class="built_in">print</span>(response.content)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>```json<br>{<br>    “gift”: false,<br>    “delivery_days”: “2”,<br>    “price_value”: “It’s slightly more expensive than the other leaf blowers out there, but I think it’s worth it for the extra features.”<br>}</p>
<p>```</p>
</blockquote>
<p>转化为字典：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">output_dict = output_parser.parse(response.content)</span><br><span class="line">output_dict</span><br></pre></td></tr></table></figure>
<p>这样就可以用键查找到值了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">output_dict.get(<span class="string">&#x27;delivery_days&#x27;</span>)</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">KennyCaty</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/AI/langchain/Langchain(1)/">http://example.com/AI/langchain/Langchain(1)/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">KennyCaty-啃泥猫-BLOG</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Langchain/">Langchain</a></div><div class="post_share"><div class="social-share" data-image="https://w.wallhaven.cc/full/vq/wallhaven-vqgzql.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/reward/wechatpay.png" target="_blank"><img class="post-qr-code-img" src="/img/reward/wechatpay.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/reward/alipay.png" target="_blank"><img class="post-qr-code-img" src="/img/reward/alipay.png" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/AI/langchain/Langchain(2)/" title="LangChain（二）：Memory"><img class="cover" src="https://w.wallhaven.cc/full/g7/wallhaven-g73kk3.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">LangChain（二）：Memory</div></div></a></div><div class="next-post pull-right"><a href="/Flask-Learning/" title="Flask框架笔记"><img class="cover" src="https://w.wallhaven.cc/full/vq/wallhaven-vqmer8.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Flask框架笔记</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/AI/langchain/Langchain(2)/" title="LangChain（二）：Memory"><img class="cover" src="https://w.wallhaven.cc/full/g7/wallhaven-g73kk3.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-17</div><div class="title">LangChain（二）：Memory</div></div></a></div><div><a href="/AI/langchain/Langchain-01/" title="Langchain-PDFGPT"><img class="cover" src="https://w.wallhaven.cc/full/d6/wallhaven-d6egrm.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-12</div><div class="title">Langchain-PDFGPT</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/kennycaty.ico" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">KennyCaty</div><div class="author-info__description">From Hainan University of China</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">18</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/KennyCaty"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Models-Prompts-and-Parsers"><span class="toc-number">2.</span> <span class="toc-text">Models, Prompts and Parsers</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E5%87%BA%E6%A8%A1%E6%9D%BF"><span class="toc-number">2.1.</span> <span class="toc-text">引出模板</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8%E6%8F%90%E7%A4%BA%E6%A8%A1%E6%9D%BF"><span class="toc-number">2.2.</span> <span class="toc-text">为什么要使用提示模板</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ouput-Parser%E7%A4%BA%E4%BE%8B"><span class="toc-number">2.3.</span> <span class="toc-text">Ouput Parser示例</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/AI/ML_Lee2023/" title="Machine-Learning"><img src="https://w.wallhaven.cc/full/d6/wallhaven-d6egrm.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Machine-Learning"/></a><div class="content"><a class="title" href="/AI/ML_Lee2023/" title="Machine-Learning">Machine-Learning</a><time datetime="2023-09-20T10:51:30.000Z" title="发表于 2023-09-20 18:51:30">2023-09-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Docker/docker-install-ub20/" title="Ubuntu20安装docker"><img src="https://w.wallhaven.cc/full/vq/wallhaven-vqmer8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Ubuntu20安装docker"/></a><div class="content"><a class="title" href="/Docker/docker-install-ub20/" title="Ubuntu20安装docker">Ubuntu20安装docker</a><time datetime="2023-08-30T06:16:53.000Z" title="发表于 2023-08-30 14:16:53">2023-08-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/AI/langchain/Langchain(4)/" title="LangChain（四）： 问答检索"><img src="https://w.wallhaven.cc/full/7p/wallhaven-7p3g8y.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LangChain（四）： 问答检索"/></a><div class="content"><a class="title" href="/AI/langchain/Langchain(4)/" title="LangChain（四）： 问答检索">LangChain（四）： 问答检索</a><time datetime="2023-08-17T11:51:06.423Z" title="发表于 2023-08-17 19:51:06">2023-08-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/AI/langchain/Langchain(3)/" title="Langchain（三）：Chain"><img src="https://w.wallhaven.cc/full/1p/wallhaven-1pk58v.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Langchain（三）：Chain"/></a><div class="content"><a class="title" href="/AI/langchain/Langchain(3)/" title="Langchain（三）：Chain">Langchain（三）：Chain</a><time datetime="2023-08-17T08:50:33.000Z" title="发表于 2023-08-17 16:50:33">2023-08-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/AI/langchain/Langchain(2)/" title="LangChain（二）：Memory"><img src="https://w.wallhaven.cc/full/g7/wallhaven-g73kk3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LangChain（二）：Memory"/></a><div class="content"><a class="title" href="/AI/langchain/Langchain(2)/" title="LangChain（二）：Memory">LangChain（二）：Memory</a><time datetime="2023-08-17T07:53:36.000Z" title="发表于 2023-08-17 15:53:36">2023-08-17</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2023 By KennyCaty</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>